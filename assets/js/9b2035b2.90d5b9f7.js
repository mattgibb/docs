"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[16618],{3905:function(e,t,r){r.d(t,{Zo:function(){return u},kt:function(){return c}});var n=r(67294);function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function o(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},l=Object.keys(e);for(n=0;n<l.length;n++)r=l[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)r=l[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var s=n.createContext({}),p=function(e){var t=n.useContext(s),r=t;return e&&(r="function"==typeof e?e(t):i(i({},t),e)),r},u=function(e){var t=p(e.components);return n.createElement(s.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},d=n.forwardRef((function(e,t){var r=e.components,a=e.mdxType,l=e.originalType,s=e.parentName,u=o(e,["components","mdxType","originalType","parentName"]),d=p(r),c=a,g=d["".concat(s,".").concat(c)]||d[c]||m[c]||l;return r?n.createElement(g,i(i({ref:t},u),{},{components:r})):n.createElement(g,i({ref:t},u))}));function c(e,t){var r=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var l=r.length,i=new Array(l);i[0]=d;var o={};for(var s in t)hasOwnProperty.call(t,s)&&(o[s]=t[s]);o.originalType=e,o.mdxType="string"==typeof e?e:a,i[1]=o;for(var p=2;p<l;p++)i[p]=r[p];return n.createElement.apply(null,i)}return n.createElement.apply(null,r)}d.displayName="MDXCreateElement"},74134:function(e,t,r){r.r(t),r.d(t,{assets:function(){return u},contentTitle:function(){return s},default:function(){return c},frontMatter:function(){return o},metadata:function(){return p},toc:function(){return m}});var n=r(83117),a=r(80102),l=(r(67294),r(3905)),i=["components"],o={title:"grpc (Source)"},s=void 0,p={unversionedId:"cep/reference/functions/source/grpc",id:"cep/reference/functions/source/grpc",title:"grpc (Source)",description:"This extension starts a grpc server during initialization time. The",source:"@site/docs/cep/reference/functions/source/grpc.md",sourceDirName:"cep/reference/functions/source",slug:"/cep/reference/functions/source/grpc",permalink:"/docs/cep/reference/functions/source/grpc",draft:!1,editUrl:"https://github.com/macrometacorp/docs/edit/master/docs/cep/reference/functions/source/grpc.md",tags:[],version:"current",frontMatter:{title:"grpc (Source)"},sidebar:"tutorialSidebar",previous:{title:"grpc-service (Source)",permalink:"/docs/cep/reference/functions/source/grpc-service"},next:{title:"http-call-response (Source)",permalink:"/docs/cep/reference/functions/source/http-call-response"}},u={},m=[{value:"Query Parameters",id:"query-parameters",level:2},{value:"Example 1",id:"example-1",level:2},{value:"Example 2",id:"example-2",level:2},{value:"Example 3",id:"example-3",level:2},{value:"Example 4",id:"example-4",level:2},{value:"Example 5",id:"example-5",level:2}],d={toc:m};function c(e){var t=e.components,r=(0,a.Z)(e,i);return(0,l.kt)("wrapper",(0,n.Z)({},d,r,{components:t,mdxType:"MDXLayout"}),(0,l.kt)("p",null,"This extension starts a grpc server during initialization time. The\nserver listens to requests from grpc stubs. This source has a default\nmode of operation and custom user defined grpc service mode. By default\nthis uses EventService.\nIn the default mode this source will use EventService consume method. If\nwe want to use our custom gRPC services, we have to pack auto-generated\ngRPC service classes and protobuf classes into a jar file and add it\ninto the project classpath (or to the ",(0,l.kt)("inlineCode",{parentName:"p"},"jars")," folder in the\n",(0,l.kt)("inlineCode",{parentName:"p"},"streamprocessor-tooling")," folder if we use it with ",(0,l.kt)("inlineCode",{parentName:"p"},"streamprocessor-tooling"),").\nThis method will receive requests and injects them into stream through a\nmapper."),(0,l.kt)("p",null,"Syntax"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'CREATE SOURCE <NAME> WITH (type="grpc", map.type="<STRING>", receiver.url="<STRING>", max.inbound.message.size="<INT>", max.inbound.metadata.size="<INT>", server.shutdown.waiting.time="<LONG>", truststore.file="<STRING>", truststore.password="<STRING>", truststore.algorithm="<STRING>", tls.store.type="<STRING>", keystore.file="<STRING>", keystore.password="<STRING>", keystore.algorithm="<STRING>", enable.ssl="<BOOL>", mutual.auth.enabled="<BOOL>", threadpool.size="<INT>", threadpool.buffer.size="<INT>")\n')),(0,l.kt)("h2",{id:"query-parameters"},"Query Parameters"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Name"),(0,l.kt)("th",{parentName:"tr",align:null},"Description"),(0,l.kt)("th",{parentName:"tr",align:null},"Default Value"),(0,l.kt)("th",{parentName:"tr",align:null},"Possible Data Types"),(0,l.kt)("th",{parentName:"tr",align:null},"Optional"),(0,l.kt)("th",{parentName:"tr",align:null},"Dynamic"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"receiver.url"),(0,l.kt)("td",{parentName:"tr",align:null},"The url which can be used by a client to access the grpc server in this extension. This url should consist the host hostPort, port, fully qualified service name, method name in the following format. ",(0,l.kt)("inlineCode",{parentName:"td"},"grpc://0.0.0.0:9763/<serviceName>/<methodName>")," For example: grpc://0.0.0.0:9763/org.gdn.grpc.EventService/consume"),(0,l.kt)("td",{parentName:"tr",align:null}),(0,l.kt)("td",{parentName:"tr",align:null},"STRING"),(0,l.kt)("td",{parentName:"tr",align:null},"No"),(0,l.kt)("td",{parentName:"tr",align:null},"No")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"max.inbound.message.size"),(0,l.kt)("td",{parentName:"tr",align:null},"Sets the maximum message size in bytes allowed to be received on the server."),(0,l.kt)("td",{parentName:"tr",align:null},"4194304"),(0,l.kt)("td",{parentName:"tr",align:null},"INT"),(0,l.kt)("td",{parentName:"tr",align:null},"Yes"),(0,l.kt)("td",{parentName:"tr",align:null},"No")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"max.inbound.metadata.size"),(0,l.kt)("td",{parentName:"tr",align:null},"Sets the maximum size of metadata in bytes allowed to be received."),(0,l.kt)("td",{parentName:"tr",align:null},"8192"),(0,l.kt)("td",{parentName:"tr",align:null},"INT"),(0,l.kt)("td",{parentName:"tr",align:null},"Yes"),(0,l.kt)("td",{parentName:"tr",align:null},"No")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"server.shutdown.waiting.time"),(0,l.kt)("td",{parentName:"tr",align:null},"The time in seconds to wait for the server to shutdown, giving up if the timeout is reached."),(0,l.kt)("td",{parentName:"tr",align:null},"5"),(0,l.kt)("td",{parentName:"tr",align:null},"LONG"),(0,l.kt)("td",{parentName:"tr",align:null},"Yes"),(0,l.kt)("td",{parentName:"tr",align:null},"No")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"truststore.file"),(0,l.kt)("td",{parentName:"tr",align:null},"the file path of truststore. If this is provided then server authentication is enabled"),(0,l.kt)("td",{parentName:"tr",align:null},"-"),(0,l.kt)("td",{parentName:"tr",align:null},"STRING"),(0,l.kt)("td",{parentName:"tr",align:null},"Yes"),(0,l.kt)("td",{parentName:"tr",align:null},"No")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"truststore.password"),(0,l.kt)("td",{parentName:"tr",align:null},"the password of truststore. If this is provided then the integrity of the keystore is checked"),(0,l.kt)("td",{parentName:"tr",align:null},"-"),(0,l.kt)("td",{parentName:"tr",align:null},"STRING"),(0,l.kt)("td",{parentName:"tr",align:null},"Yes"),(0,l.kt)("td",{parentName:"tr",align:null},"No")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"truststore.algorithm"),(0,l.kt)("td",{parentName:"tr",align:null},"the encryption algorithm to be used for server authentication"),(0,l.kt)("td",{parentName:"tr",align:null},"-"),(0,l.kt)("td",{parentName:"tr",align:null},"STRING"),(0,l.kt)("td",{parentName:"tr",align:null},"Yes"),(0,l.kt)("td",{parentName:"tr",align:null},"No")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"tls.store.type"),(0,l.kt)("td",{parentName:"tr",align:null},"TLS store type"),(0,l.kt)("td",{parentName:"tr",align:null},"-"),(0,l.kt)("td",{parentName:"tr",align:null},"STRING"),(0,l.kt)("td",{parentName:"tr",align:null},"Yes"),(0,l.kt)("td",{parentName:"tr",align:null},"No")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"keystore.file"),(0,l.kt)("td",{parentName:"tr",align:null},"the file path of keystore. If this is provided then client authentication is enabled"),(0,l.kt)("td",{parentName:"tr",align:null},"-"),(0,l.kt)("td",{parentName:"tr",align:null},"STRING"),(0,l.kt)("td",{parentName:"tr",align:null},"Yes"),(0,l.kt)("td",{parentName:"tr",align:null},"No")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"keystore.password"),(0,l.kt)("td",{parentName:"tr",align:null},"the password of keystore"),(0,l.kt)("td",{parentName:"tr",align:null},"-"),(0,l.kt)("td",{parentName:"tr",align:null},"STRING"),(0,l.kt)("td",{parentName:"tr",align:null},"Yes"),(0,l.kt)("td",{parentName:"tr",align:null},"No")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"keystore.algorithm"),(0,l.kt)("td",{parentName:"tr",align:null},"the encryption algorithm to be used for client authentication"),(0,l.kt)("td",{parentName:"tr",align:null},"-"),(0,l.kt)("td",{parentName:"tr",align:null},"STRING"),(0,l.kt)("td",{parentName:"tr",align:null},"Yes"),(0,l.kt)("td",{parentName:"tr",align:null},"No")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"enable.ssl"),(0,l.kt)("td",{parentName:"tr",align:null},"to enable ssl. If set to true and keystore.file is not given then it will be set to default carbon jks by default"),(0,l.kt)("td",{parentName:"tr",align:null},"FALSE"),(0,l.kt)("td",{parentName:"tr",align:null},"BOOL"),(0,l.kt)("td",{parentName:"tr",align:null},"Yes"),(0,l.kt)("td",{parentName:"tr",align:null},"No")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"mutual.auth.enabled"),(0,l.kt)("td",{parentName:"tr",align:null},"to enable mutual authentication. If set to true and keystore.file or truststore.file is not given then it will be set to default carbon jks by default"),(0,l.kt)("td",{parentName:"tr",align:null},"FALSE"),(0,l.kt)("td",{parentName:"tr",align:null},"BOOL"),(0,l.kt)("td",{parentName:"tr",align:null},"Yes"),(0,l.kt)("td",{parentName:"tr",align:null},"No")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"threadpool.size"),(0,l.kt)("td",{parentName:"tr",align:null},"Sets the maximum size of threadpool dedicated to serve requests at the gRPC server"),(0,l.kt)("td",{parentName:"tr",align:null},"100"),(0,l.kt)("td",{parentName:"tr",align:null},"INT"),(0,l.kt)("td",{parentName:"tr",align:null},"Yes"),(0,l.kt)("td",{parentName:"tr",align:null},"No")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"threadpool.buffer.size"),(0,l.kt)("td",{parentName:"tr",align:null},"Sets the maximum size of threadpool buffer server"),(0,l.kt)("td",{parentName:"tr",align:null},"100"),(0,l.kt)("td",{parentName:"tr",align:null},"INT"),(0,l.kt)("td",{parentName:"tr",align:null},"Yes"),(0,l.kt)("td",{parentName:"tr",align:null},"No")))),(0,l.kt)("p",null,"System Parameters"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Name"),(0,l.kt)("th",{parentName:"tr",align:null},"Description"),(0,l.kt)("th",{parentName:"tr",align:null},"Default Value"),(0,l.kt)("th",{parentName:"tr",align:null},"Possible Parameters"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"keyStoreFile"),(0,l.kt)("td",{parentName:"tr",align:null},"Path of the key store file"),(0,l.kt)("td",{parentName:"tr",align:null},"\\${carbon.home}/resources/security/gdncarbon.jks"),(0,l.kt)("td",{parentName:"tr",align:null},"valid path for a key store file")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"keyStorePassword"),(0,l.kt)("td",{parentName:"tr",align:null},"This is the password used with key store file"),(0,l.kt)("td",{parentName:"tr",align:null},"gdncarbon"),(0,l.kt)("td",{parentName:"tr",align:null},"valid password for the key store file")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"keyStoreAlgorithm"),(0,l.kt)("td",{parentName:"tr",align:null},"The encryption algorithm to be used for client authentication"),(0,l.kt)("td",{parentName:"tr",align:null},"SunX509"),(0,l.kt)("td",{parentName:"tr",align:null},"-")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"trustStoreFile"),(0,l.kt)("td",{parentName:"tr",align:null},"This is the trust store file with the path"),(0,l.kt)("td",{parentName:"tr",align:null},"\\${carbon.home}/resources/security/client-truststore.jks"),(0,l.kt)("td",{parentName:"tr",align:null},"-")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"trustStorePassword"),(0,l.kt)("td",{parentName:"tr",align:null},"This is the password used with trust store file"),(0,l.kt)("td",{parentName:"tr",align:null},"gdncarbon"),(0,l.kt)("td",{parentName:"tr",align:null},"valid password for the trust store file")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"trustStoreAlgorithm"),(0,l.kt)("td",{parentName:"tr",align:null},"the encryption algorithm to be used for server authentication"),(0,l.kt)("td",{parentName:"tr",align:null},"SunX509"),(0,l.kt)("td",{parentName:"tr",align:null},"-")))),(0,l.kt)("h2",{id:"example-1"},"Example 1"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"CREATE SOURCE BarStream WITH (type='grpc', receiver.url='grpc://localhost:8888/org.gdn.grpc.EventService/consume', map.type='json') (message String);\n")),(0,l.kt)("p",null,"Here the port is given as 8888. So a grpc server will be started on port\n8888 and the server will expose EventService. This is the default\nservice packed with the source. In EventService the consume method is"),(0,l.kt)("h2",{id:"example-2"},"Example 2"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"CREATE SOURCE BarStream WITH (type='grpc', receiver.url='grpc://localhost:8888/org.gdn.grpc.EventService/consume', map.type='json', map.attributes=\"name='trp:name', age='trp:age', message='message'\") (message String, name String, age int);\n")),(0,l.kt)("p",null,"Here we are getting headers sent with the request as transport\nproperties and injecting them into the stream. With each request a\nheader will be sent in MetaData in the following format: ",(0,l.kt)("inlineCode",{parentName:"p"},"Name:John"),",\n",(0,l.kt)("inlineCode",{parentName:"p"},"Age:23")),(0,l.kt)("h2",{id:"example-3"},"Example 3"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"CREATE SOURCE BarStream WITH (type='grpc', receiver.url='grpc://localhost:8888/org.gdn.grpc.MyService/send', map.type='protobuf') (stringValue string, intValue int,longValue long,booleanValue bool,floatValue float,doubleValue double);\n")),(0,l.kt)("p",null,"Here the port is given as 8888. So a grpc server will be started on port\n8888 and sever will keep listening to the ",(0,l.kt)("inlineCode",{parentName:"p"},"send")," RPC method in the\n",(0,l.kt)("inlineCode",{parentName:"p"},"MyService")," service."),(0,l.kt)("h2",{id:"example-4"},"Example 4"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"CREATE SOURCE BarStream WITH (type='grpc', receiver.url='grpc://localhost:8888/org.gdn.grpc.MyService/send', map.type='protobuf', attributes=\"a = 'stringValue', b = 'intValue', c = 'longValue',d = 'booleanValue', e ='floatValue', f ='doubleValue'\") (a string ,c long,b int, d bool,e float,f double);\n")),(0,l.kt)("p",null,"Here the port is given as 8888. So a grpc server will be started on port\n8888 and sever will keep listening to the ",(0,l.kt)("inlineCode",{parentName:"p"},"send")," method in the\n",(0,l.kt)("inlineCode",{parentName:"p"},"MyService")," service. Since we provide mapping in the stream we can use\nany names for stream attributes, but we have to map those names with\ncorrect protobuf message attributes' names. If we want to send\nmetadata, we should map the attributes."),(0,l.kt)("h2",{id:"example-5"},"Example 5"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"CREATE SOURCE BarStream WITH (type='grpc', receiver.url='grpc://localhost:8888/org.gdn.grpc.StreamService/clientStream', map.type='protobuf') (stringValue string, intValue int,longValue long,booleanValue bool,floatValue float,doubleValue double);\n")),(0,l.kt)("p",null,"Here we receive a stream of requests to the grpc source. Whenever we\nwant to use streaming with grpc source, we have to define the RPC method\nas client streaming method,\nwhen we define a stream method stream processor will identify it as a stream RPC\nmethod and ready to accept stream of request from the client."))}c.isMDXComponent=!0}}]);