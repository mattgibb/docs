"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[4158],{3905:function(e,t,n){n.d(t,{Zo:function(){return c},kt:function(){return m}});var a=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=a.createContext({}),p=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},c=function(e){var t=p(e.components);return a.createElement(s.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,s=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),d=p(n),m=r,f=d["".concat(s,".").concat(m)]||d[m]||u[m]||i;return n?a.createElement(f,o(o({ref:t},c),{},{components:n})):a.createElement(f,o({ref:t},c))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,o=new Array(i);o[0]=d;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:r,o[1]=l;for(var p=2;p<i;p++)o[p]=n[p];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},62291:function(e,t,n){n.r(t),n.d(t,{assets:function(){return c},contentTitle:function(){return s},default:function(){return m},frontMatter:function(){return l},metadata:function(){return p},toc:function(){return u}});var a=n(83117),r=n(80102),i=(n(67294),n(3905)),o=["components"],l={sidebar_position:2,title:"FOR"},s=void 0,p={unversionedId:"c8ql/operations/for",id:"c8ql/operations/for",title:"FOR",description:"The versatile FOR keyword can be used to iterate over a collection or View, all elements of an array or to traverse a graph.",source:"@site/docs/c8ql/operations/for.md",sourceDirName:"c8ql/operations",slug:"/c8ql/operations/for",permalink:"/docs/c8ql/operations/for",draft:!1,editUrl:"https://github.com/macrometacorp/docs/edit/master/docs/c8ql/operations/for.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2,title:"FOR"},sidebar:"tutorialSidebar",previous:{title:"Operations",permalink:"/docs/c8ql/operations/"},next:{title:"RETURN",permalink:"/docs/c8ql/operations/return"}},c={},u=[{value:"General Syntax",id:"general-syntax",level:2},{value:"Options",id:"options",level:2},{value:"Index hints",id:"index-hints",level:2}],d={toc:u};function m(e){var t=e.components,n=(0,r.Z)(e,o);return(0,i.kt)("wrapper",(0,a.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"The versatile ",(0,i.kt)("inlineCode",{parentName:"p"},"FOR")," keyword can be used to iterate over a collection or View, all elements of an array or to traverse a graph."),(0,i.kt)("h2",{id:"general-syntax"},"General Syntax"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"FOR variableName IN expression\n")),(0,i.kt)("p",null,"There is also a special variant for ",(0,i.kt)("a",{parentName:"p",href:"/docs/c8ql/graphs/traversals"},"graph traversals"),":"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"FOR vertexVariableName, edgeVariableName, pathVariableName IN traversalExpression\n")),(0,i.kt)("p",null,"For Views, there is a special (optional) ",(0,i.kt)("a",{parentName:"p",href:"/docs/c8ql/operations/search"},(0,i.kt)("inlineCode",{parentName:"a"},"SEARCH")," keyword"),":"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"FOR variableName IN viewName SEARCH searchExpression\n")),(0,i.kt)("p",null,"Note that Views cannot be used as edge collections in traversals:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"FOR v IN 1..3 ANY startVertex viewName /* invalid! */\n")),(0,i.kt)("p",null,"Each array element returned by ",(0,i.kt)("em",{parentName:"p"},"expression")," is visited exactly once. It is required that ",(0,i.kt)("em",{parentName:"p"},"expression")," returns an array in all cases. The empty array is allowed, too. The current array element is made available for further processing in the variable specified by ",(0,i.kt)("em",{parentName:"p"},"variableName"),"."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"FOR u IN users\n  RETURN u\n")),(0,i.kt)("p",null,"This will iterate over all elements from the array ",(0,i.kt)("em",{parentName:"p"},"users"),' (note: this array consists of all documents from the collection named "users" in this case) and make the current array element available in variable ',(0,i.kt)("em",{parentName:"p"},"u"),". ",(0,i.kt)("em",{parentName:"p"},"u")," is not modified in this example but simply pushed into the result using the ",(0,i.kt)("inlineCode",{parentName:"p"},"RETURN")," keyword."),(0,i.kt)("admonition",{type:"note"},(0,i.kt)("p",{parentName:"admonition"},"When iterating over collection-based arrays as shown here, the order of documents is undefined unless an explicit sort order is defined using a ",(0,i.kt)("inlineCode",{parentName:"p"},"SORT")," statement.")),(0,i.kt)("p",null,"The variable introduced by ",(0,i.kt)("inlineCode",{parentName:"p"},"FOR")," is available until the scope the ",(0,i.kt)("inlineCode",{parentName:"p"},"FOR")," is placed in is closed."),(0,i.kt)("p",null,"Another example that uses a statically declared array of values to iterate over:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},'FOR year IN [ 2011, 2012, 2013 ]\n  RETURN { "year" : year, "isLeapYear" : year % 4 == 0 && (year % 100 != 0 || year % 400 == 0) }\n')),(0,i.kt)("p",null,"Nesting of multiple ",(0,i.kt)("inlineCode",{parentName:"p"},"FOR")," statements is allowed, too. When ",(0,i.kt)("inlineCode",{parentName:"p"},"FOR")," statements are nested, a cross product of the array elements returned by the individual ",(0,i.kt)("inlineCode",{parentName:"p"},"FOR")," statements will be created."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},'FOR u IN users\n  FOR l IN locations\n    RETURN { "user" : u, "location" : l }\n')),(0,i.kt)("p",null,"In this example, there are two array iterations: an outer iteration over the array ",(0,i.kt)("em",{parentName:"p"},"users")," plus an inner iteration over the array ",(0,i.kt)("em",{parentName:"p"},"locations"),". The inner array is traversed as many times as there are elements in the outer array.  For each iteration, the current values of ",(0,i.kt)("em",{parentName:"p"},"users")," and ",(0,i.kt)("em",{parentName:"p"},"locations")," are made available for further processing in the variable ",(0,i.kt)("em",{parentName:"p"},"u")," and ",(0,i.kt)("em",{parentName:"p"},"l"),"."),(0,i.kt)("h2",{id:"options"},"Options"),(0,i.kt)("p",null,"For collections and views, the ",(0,i.kt)("inlineCode",{parentName:"p"},"FOR")," construct supports an optional ",(0,i.kt)("inlineCode",{parentName:"p"},"OPTIONS")," suffix to modify behavior. The general syntax is:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"FOR variableName IN expression OPTIONS {option: value, ...}\n")),(0,i.kt)("h2",{id:"index-hints"},"Index hints"),(0,i.kt)("p",null,"For collections, index hints are provided though this inline options mechanism. Hints can be specified in two different formats."),(0,i.kt)("p",null,"The first format option is the simplest, just a single index name. This should be sufficient for many cases. Whenever there is a choice to potentially use an index for this ",(0,i.kt)("inlineCode",{parentName:"p"},"FOR")," loop, the optimizer will first check if the specified index can be used. If so, it will use it, regardless of whether it would normally use a different index. If it cannot use that index, then it will fall back to its normal logic to select another index. "),(0,i.kt)("p",null,"If the optional ",(0,i.kt)("inlineCode",{parentName:"p"},"forceIndexHint: true")," is specified, then it will not fall back, and instead generate an error."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"OPTIONS {indexHint: 'byName'[, forceIndexHint: <boolean>]}\n")),(0,i.kt)("p",null,"The second is an array of index names, in order of preference. When specified this way, the optimizer will behave much in the same way as above, but will check the feasibility of each of the specified indices, in the order they are given, falling back to its normal logic or failing only if none of the specified indices are feasible."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"OPTIONS {indexHint: ['byName', 'byColor'][, forceIndexHint: <boolean>]}\n")))}m.isMDXComponent=!0}}]);