"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[31818],{3905:function(e,t,n){n.d(t,{Zo:function(){return p},kt:function(){return d}});var r=n(67294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var u=r.createContext({}),l=function(e){var t=r.useContext(u),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},p=function(e){var t=l(e.components);return r.createElement(u.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},m=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,u=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),m=l(n),d=a,b=m["".concat(u,".").concat(d)]||m[d]||c[d]||o;return n?r.createElement(b,i(i({ref:t},p),{},{components:n})):r.createElement(b,i({ref:t},p))}));function d(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,i=new Array(o);i[0]=m;var s={};for(var u in t)hasOwnProperty.call(t,u)&&(s[u]=t[u]);s.originalType=e,s.mdxType="string"==typeof e?e:a,i[1]=s;for(var l=2;l<o;l++)i[l]=n[l];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}m.displayName="MDXCreateElement"},26589:function(e,t,n){n.r(t),n.d(t,{assets:function(){return p},contentTitle:function(){return u},default:function(){return d},frontMatter:function(){return s},metadata:function(){return l},toc:function(){return c}});var r=n(83117),a=n(80102),o=(n(67294),n(3905)),i=["components"],s={title:"Bind Parameters"},u=void 0,l={unversionedId:"queryworkers/bind-parameters",id:"queryworkers/bind-parameters",title:"Bind Parameters",description:"C8QL supports the usage of bind parameters, thus allowing to separate the query text from literal values used in the query. It is good practice to separate the query text from the literal values because this will prevent (malicious) injection of keywords and other collection names into an existing query. This injection would be dangerous because it may change the meaning of an existing query.",source:"@site/docs/queryworkers/bind-parameters.md",sourceDirName:"queryworkers",slug:"/queryworkers/bind-parameters",permalink:"/docs/queryworkers/bind-parameters",draft:!1,editUrl:"https://github.com/macrometacorp/docs/edit/master/docs/queryworkers/bind-parameters.md",tags:[],version:"current",frontMatter:{title:"Bind Parameters"},sidebar:"tutorialSidebar",previous:{title:"Query Worker Tutorial",permalink:"/docs/queryworkers/tutorial"},next:{title:"Data Access Queries",permalink:"/docs/queryworkers/data-access-queries"}},p={},c=[],m={toc:c};function d(e){var t=e.components,n=(0,a.Z)(e,i);return(0,o.kt)("wrapper",(0,r.Z)({},m,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"C8QL supports the usage of bind parameters, thus allowing to separate the query text from literal values used in the query. It is good practice to separate the query text from the literal values because this will prevent (malicious) injection of keywords and other collection names into an existing query. This injection would be dangerous because it may change the meaning of an existing query."),(0,o.kt)("p",null,"Using bind parameters, the meaning of an existing query cannot be changed. Bind parameters can be used everywhere in a query where literals can be used."),(0,o.kt)("p",null,"The syntax for bind parameters is ",(0,o.kt)("inlineCode",{parentName:"p"},"@name")," where ",(0,o.kt)("inlineCode",{parentName:"p"},"@")," signifies that this is a bind parameter and ",(0,o.kt)("inlineCode",{parentName:"p"},"name")," is the actual parameter name. Parameter names must start with any of the letters ",(0,o.kt)("inlineCode",{parentName:"p"},"a")," to ",(0,o.kt)("inlineCode",{parentName:"p"},"z")," (upper or lower case) or a digit (",(0,o.kt)("inlineCode",{parentName:"p"},"0")," to ",(0,o.kt)("inlineCode",{parentName:"p"},"9"),"), and can be followed by any letter, digit or the underscore symbol."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"FOR u IN users\n  FILTER u.id == @id && u.name == @name\n  RETURN u\n")),(0,o.kt)("p",null,"The bind parameter values need to be passed along with the query when it is executed, but not as part of the query text itself. In the web interface, there is a pane next to the query editor where the bind parameters can be entered."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "query": "FOR u IN users FILTER u.id == @id && u.name == @name RETURN u",\n  "bindVars": {\n    "id": 123,\n    "name": "John Smith"\n  }\n}\n')),(0,o.kt)("p",null,"Bind parameters that are declared in the query must also be passed a parameter value, or the query will fail. Specifying parameters that are not declared in the query will result in an error too."),(0,o.kt)("p",null,"Bind variables represent a value like a string, and must not be put in quotes in the C8QL code:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'FILTER u.name == "@name" // wrong\nFILTER u.name == @name   // correct\n')),(0,o.kt)("p",null,"If you need to do string processing (concatenation, etc.) in the query, you need to use ",(0,o.kt)("a",{parentName:"p",href:"/docs/c8ql/functions/string"},"string functions")," to do so:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"FOR u IN users\n  FILTER u.id == CONCAT('prefix', @id, 'suffix') && u.name == @name\n  RETURN u\n")),(0,o.kt)("p",null,"Bind paramers can be used for both, the dot notation as well as the square bracket notation for sub-attribute access. They can also be chained:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'LET doc = { foo: { bar: "baz" } }\n\nRETURN doc.@attr.@subattr\n// or\nRETURN doc[@attr][@subattr]\n')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "attr": "foo",\n  "subattr": "bar"\n}\n')),(0,o.kt)("p",null,"Both variants in above example return ",(0,o.kt)("inlineCode",{parentName:"p"},'[ "baz" ]')," as query result."),(0,o.kt)("p",null,"The whole attribute path, for highly nested data in particular, can also be specified using the dot notation and a single bind parameter, by passing an array of strings as parameter value. The elements of the array represent the attribute keys of the path:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"LET doc = { a: { b: { c: 1 } } }\nRETURN doc.@attr\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'{ "attr": [ "a", "b", "c" ] }\n')),(0,o.kt)("p",null,"The example query returns ",(0,o.kt)("inlineCode",{parentName:"p"},"[ 1 ]")," as result. Note that ",(0,o.kt)("inlineCode",{parentName:"p"},'{ "attr": "a.b.c" }')," would return the value of an attribute called ",(0,o.kt)("em",{parentName:"p"},"a.b.c"),", not the value of attribute ",(0,o.kt)("em",{parentName:"p"},"c")," with the parents ",(0,o.kt)("em",{parentName:"p"},"a")," and ",(0,o.kt)("em",{parentName:"p"},"b")," as ",(0,o.kt)("inlineCode",{parentName:"p"},'[ "a", "b", "c" ]')," would."),(0,o.kt)("p",null,"A special type of bind parameter exists for injecting collection names. This type of bind parameter has a name prefixed with an additional ",(0,o.kt)("em",{parentName:"p"},"@")," symbol (thus when using the bind parameter in a query, two ",(0,o.kt)("em",{parentName:"p"},"@")," symbols must be used)."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"FOR u IN @@collection\n  FILTER u.active == true\n  RETURN u\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'{ "@collection": "myCollection" }\n')),(0,o.kt)("p",null,"Keywords can't be replaced by bind-values; i.e. ",(0,o.kt)("inlineCode",{parentName:"p"},"FOR"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"FILTER"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"IN"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"INBOUND")," or function calls."))}d.isMDXComponent=!0}}]);