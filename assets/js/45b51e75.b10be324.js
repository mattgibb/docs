"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[45394],{3905:function(e,t,n){n.d(t,{Zo:function(){return l},kt:function(){return m}});var r=n(67294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var u=r.createContext({}),c=function(e){var t=r.useContext(u),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},l=function(e){var t=c(e.components);return r.createElement(u.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,u=e.parentName,l=s(e,["components","mdxType","originalType","parentName"]),d=c(n),m=a,f=d["".concat(u,".").concat(m)]||d[m]||p[m]||o;return n?r.createElement(f,i(i({ref:t},l),{},{components:n})):r.createElement(f,i({ref:t},l))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,i=new Array(o);i[0]=d;var s={};for(var u in t)hasOwnProperty.call(t,u)&&(s[u]=t[u]);s.originalType=e,s.mdxType="string"==typeof e?e:a,i[1]=s;for(var c=2;c<o;c++)i[c]=n[c];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}d.displayName="MDXCreateElement"},88120:function(e,t,n){n.r(t),n.d(t,{assets:function(){return l},contentTitle:function(){return u},default:function(){return m},frontMatter:function(){return s},metadata:function(){return c},toc:function(){return p}});var r=n(83117),a=n(80102),o=(n(67294),n(3905)),i=["components"],s={title:"Data Access Queries"},u=void 0,c={unversionedId:"queryworkers/data-access-queries",id:"queryworkers/data-access-queries",title:"Data Access Queries",description:"Retrieving data from the database with C8QL does always include a RETURN operation. It can be used to return a static value, such as a string:",source:"@site/docs/queryworkers/data-access-queries.md",sourceDirName:"queryworkers",slug:"/queryworkers/data-access-queries",permalink:"/docs/queryworkers/data-access-queries",draft:!1,editUrl:"https://github.com/macrometacorp/docs/edit/master/docs/queryworkers/data-access-queries.md",tags:[],version:"current",frontMatter:{title:"Data Access Queries"},sidebar:"tutorialSidebar",previous:{title:"Bind Parameters",permalink:"/docs/queryworkers/bind-parameters"},next:{title:"Data Modification Queries",permalink:"/docs/queryworkers/data-modification-queries"}},l={},p=[],d={toc:p};function m(e){var t=e.components,n=(0,a.Z)(e,i);return(0,o.kt)("wrapper",(0,r.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"Retrieving data from the database with C8QL does always include a ",(0,o.kt)("strong",{parentName:"p"},"RETURN")," operation. It can be used to return a static value, such as a string:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'RETURN "Hello C8!"\n')),(0,o.kt)("p",null,"The query result is always an array of elements, even if a single element was returned and contains a single element in that case: ",(0,o.kt)("inlineCode",{parentName:"p"},'["Hello C8!"]')),(0,o.kt)("p",null,"The function ",(0,o.kt)("inlineCode",{parentName:"p"},"DOCUMENT()")," can be called to retrieve a single document via its document handle, for instance:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'RETURN DOCUMENT("users/phil")\n')),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"RETURN")," is usually accompanied by a ",(0,o.kt)("inlineCode",{parentName:"p"},"FOR")," loop to iterate over the documents of a collection. "),(0,o.kt)("p",null,"The following query executes the loop body for all documents of a collection called ",(0,o.kt)("inlineCode",{parentName:"p"},"users"),". Each document is returned unchanged in this example:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"FOR doc IN users\n    RETURN doc\n")),(0,o.kt)("p",null,"Instead of returning the raw ",(0,o.kt)("inlineCode",{parentName:"p"},"doc"),", one can easily create a projection:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"FOR doc IN users\n    RETURN { user: doc, newAttribute: true }\n")),(0,o.kt)("p",null,"For every user document, an object with two attributes is returned. The value of the attribute ",(0,o.kt)("inlineCode",{parentName:"p"},"user")," is set to the content of the user document, and ",(0,o.kt)("inlineCode",{parentName:"p"},"newAttribute")," is a static attribute with the boolean value ",(0,o.kt)("em",{parentName:"p"},"true"),"."),(0,o.kt)("p",null,"Operations like ",(0,o.kt)("strong",{parentName:"p"},"FILTER"),", ",(0,o.kt)("strong",{parentName:"p"},"SORT")," and ",(0,o.kt)("strong",{parentName:"p"},"LIMIT")," can be added to the loop body to narrow and order the result. Instead of above shown call to ",(0,o.kt)("inlineCode",{parentName:"p"},"DOCUMENT()"),", one can also retrieve the document that describes user ",(0,o.kt)("inlineCode",{parentName:"p"},"phil")," like so:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'FOR doc IN users\n    FILTER doc._key == "phil"\n    RETURN doc\n')),(0,o.kt)("p",null,"The document key is used in this example, but any other attribute could equally be used for filtering. Since the document key is guaranteed to be unique, no more than a single document will match this filter. For other attributes this may not be the case."),(0,o.kt)("p",null,"To return a subset of active users (determined by an attribute called ",(0,o.kt)("inlineCode",{parentName:"p"},"status"),"), sorted by name in ascending order, you can do:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'FOR doc IN users\n    FILTER doc.status == "active"\n    SORT doc.name\n    LIMIT 10\n')),(0,o.kt)("admonition",{type:"note"},(0,o.kt)("p",{parentName:"admonition"},"Operations do not have to occur in a fixed order and that their order can influence the result significantly. Limiting the number of documents before a filter is usually not what you want, because it easily misses a lot of documents that would fulfill the filter criterion, but are ignored because of a premature ",(0,o.kt)("inlineCode",{parentName:"p"},"LIMIT")," clause.  Because of the aforementioned reasons, ",(0,o.kt)("inlineCode",{parentName:"p"},"LIMIT")," is usually put at the very end, after ",(0,o.kt)("inlineCode",{parentName:"p"},"FILTER"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"SORT")," and other operations.")),(0,o.kt)("p",null,"Refer to ",(0,o.kt)("a",{parentName:"p",href:"/docs/c8ql/operations/"},"C8QL Operations")," for more information."))}m.isMDXComponent=!0}}]);