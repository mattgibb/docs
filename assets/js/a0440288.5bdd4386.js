"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[68123],{3905:function(e,t,a){a.d(t,{Zo:function(){return d},kt:function(){return m}});var r=a(67294);function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function s(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var l=r.createContext({}),c=function(e){var t=r.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},d=function(e){var t=c(e.components);return r.createElement(l.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},p=r.forwardRef((function(e,t){var a=e.components,n=e.mdxType,o=e.originalType,l=e.parentName,d=s(e,["components","mdxType","originalType","parentName"]),p=c(a),m=n,h=p["".concat(l,".").concat(m)]||p[m]||u[m]||o;return a?r.createElement(h,i(i({ref:t},d),{},{components:a})):r.createElement(h,i({ref:t},d))}));function m(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var o=a.length,i=new Array(o);i[0]=p;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:n,i[1]=s;for(var c=2;c<o;c++)i[c]=a[c];return r.createElement.apply(null,i)}return r.createElement.apply(null,a)}p.displayName="MDXCreateElement"},67e3:function(e,t,a){a.r(t),a.d(t,{assets:function(){return d},contentTitle:function(){return l},default:function(){return m},frontMatter:function(){return s},metadata:function(){return c},toc:function(){return u}});var r=a(83117),n=a(80102),o=(a(67294),a(3905)),i=["components"],s={sidebar_position:30,title:"What is Macrometa"},l=void 0,c={unversionedId:"what-is-macrometa",id:"what-is-macrometa",title:"What is Macrometa",description:"Macrometa Global Data Network (GDN) is a geo-distributed, real-time, coordination-free materialized views engine. GDN supports multiple data models, making it flexible and compatible with many database types.",source:"@site/docs/what-is-macrometa.md",sourceDirName:".",slug:"/what-is-macrometa",permalink:"/docs/what-is-macrometa",draft:!1,editUrl:"https://github.com/macrometacorp/docs/edit/master/docs/what-is-macrometa.md",tags:[],version:"current",sidebarPosition:30,frontMatter:{sidebar_position:30,title:"What is Macrometa"},sidebar:"tutorialSidebar",previous:{title:"Release Notes 0.17.9",permalink:"/docs/release-notes/release-notes-0-17-09"},next:{title:"SDKs",permalink:"/docs/sdks/"}},d={},u=[{value:"GeoFabrics",id:"geofabrics",level:2},{value:"Query Workers (Query as API)",id:"query-workers-query-as-api",level:2},{value:"Sharding and Replication",id:"sharding-and-replication",level:2},{value:"Sharding",id:"sharding",level:3},{value:"Replication Within Datacenter",id:"replication-within-datacenter",level:3},{value:"Replication Across Datacenters",id:"replication-across-datacenters",level:3}],p={toc:u};function m(e){var t=e.components,s=(0,n.Z)(e,i);return(0,o.kt)("wrapper",(0,r.Z)({},p,s,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"Macrometa Global Data Network (GDN) is a geo-distributed, real-time, coordination-free materialized views engine. GDN supports multiple data models, making it flexible and compatible with many database types."),(0,o.kt)("p",null,"When you choose a database or stream processing system, you're actually choosing three technologies: storage, a data model, and an API and query language."),(0,o.kt)("admonition",{title:"Example",type:"note"},(0,o.kt)("p",{parentName:"admonition"},"If you choose Postgres, you are choosing the Postgres storage engine, a relational data model, and the SQL query language. "),(0,o.kt)("p",{parentName:"admonition"},"If you choose MongoDB, you are choosing the MongoDB distributed storage engine, a document data model, and the MongoDB API. "),(0,o.kt)("p",{parentName:"admonition"},"In systems like these, features are integrated across all layers. For example, an index provided by a data model is automatically integrated into the storage and query language.")),(0,o.kt)("p",null,"Document databases, graph databases, key-value stores, pub-sub streams, and queues make sense in the right context, and different parts of an application might call for different choices. This creates a tough decision: Use a whole new database or new streaming system to support a new data model, or try to shoehorn data into your existing database or messaging system."),(0,o.kt)("p",null,"Macrometa GDN decouples its data storage technology from its data model. You can efficiently adapt and remap real-time materialized views and log storage technology to a broad array of rich data models and streams."),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"GDN Internals",src:a(5702).Z,width:"1988",height:"1064"})),(0,o.kt)("p",null,"In a single datacenter, GDN is a ",(0,o.kt)("em",{parentName:"p"},"geo-distributed CP master/master")," model with no single point of failure:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("em",{parentName:"li"},"Geo-distributed")," means data is replicated between multiple regions, enabling clients to send requests to any region and view the same results after any latency."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("em",{parentName:"li"},"CP")," means GDN prefers consistency and partition tolerance over availability, verifying that all incoming data is processed properly before being made available to users. For more information, refer to ",(0,o.kt)("a",{parentName:"li",href:"https://en.wikipedia.org/wiki/CAP_theorem"},"CAP theorem"),"."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("em",{parentName:"li"},"Master/master")," means we use ",(0,o.kt)("a",{parentName:"li",href:"https://en.wikipedia.org/wiki/Multi-master_replication"},"multi-master replication"),", enabling clients to send requests to an arbitrary node in a data center and view the same results. This means there is no single point of failure, so the cluster can continue to serve requests even if one machine fails completely.")),(0,o.kt)("p",null,"This section gives a short outline of the GDN architecture for a single data center."),(0,o.kt)("p",null,"Macrometa GDN provides the following data models and capabilities:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Key-value stores."),(0,o.kt)("li",{parentName:"ul"},"Document stores."),(0,o.kt)("li",{parentName:"ul"},"Graphs database."),(0,o.kt)("li",{parentName:"ul"},"Global search."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://en.wikipedia.org/wiki/Publish%E2%80%93subscribe_pattern"},"Publish-subscribe (pub-sub)")," streams."),(0,o.kt)("li",{parentName:"ul"},"Stateful stream processing.")),(0,o.kt)("p",null,"GDN enables you to push data to applications in real-time across multiple data centers, dramatically reducing the time and effort needed to build scalable real-time apps."),(0,o.kt)("h2",{id:"geofabrics"},"GeoFabrics"),(0,o.kt)("p",null,"A GeoFabric is a collection of edge data centers linked together as a single high-performance virtual cloud. Each GeoFabric consists of storage, networking, and processing functions. A GeoFabric is created when a tenant account is provisioned with the edge locations. "),(0,o.kt)("p",null,"Each GeoFabric contains collections (key-value and documents), graphs, streams, stream processors and search capabilities. Data written to a GeoFabric is pinned to the locations that are part of the GeoFabric."),(0,o.kt)("p",null,"A tenant can have multiple GeoFabrics. Each GeoFabric isolates its contained data from other GeoFabrics. "),(0,o.kt)("p",null,"Each GeoFabric contains the following:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/docs/collections/"},"Collections")," are groups of JSON documents. A GeoFabric can store unlimited collections, and collections can store unlimited documents. A collection can be a ",(0,o.kt)("inlineCode",{parentName:"li"},"kv")," or ",(0,o.kt)("inlineCode",{parentName:"li"},"document")," collection."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/docs/collections/graphs/quickstart"},"Graphs")," consist of vertices and edges. Edges are stored as documents in edge collections. A vertex can be a document of a document collection or of an edge collection (so edges can be used as vertices)."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/docs/search/search"},"Search")," is a full-text search engine for information retrieval on one or more linked collections. Also referred to as ",(0,o.kt)("inlineCode",{parentName:"li"},"views"),"."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/docs/streams/quickstart"},"Streams")," are a type of collection that capture data in motion. Streams support both pub-sub and queuing models. Messages are sent via streams by publishers to consumers who then do something with the message."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/docs/cep/"},"Stream workers")," perform complex event processing in real-time on streams.")),(0,o.kt)("p",null,"For more information about GeoFabrics, refer to the ",(0,o.kt)("a",{parentName:"p",href:"/docs/geofabrics"},"GeoFabrics")," section."),(0,o.kt)("h2",{id:"query-workers-query-as-api"},"Query Workers (Query as API)"),(0,o.kt)("p",null,"A Query Worker is set of named, parameterized C8QL queries stored in GDN that you can run from a dedicated REST endpoint. The Query Worker will be created automatically globally and is available from the region closest to the user. We recommend using Query Workers to build applications backed by GDN as opposed to querying with raw C8QL directly from application code or setting up a centralized middleware."),(0,o.kt)("p",null,"Query Workers can be created and updated using the GDN Console or by using the REST API directly. Each Query Worker is tied to a specific query text and parameter set. You can set default values for query parameters (making them optional during runs of your Query Worker), or you can make them mandatory for each run (failing to pass along will result in an error)."),(0,o.kt)("p",null,"Each Query Worker is exposed as its own endpoint and is protected. The Query Workers are organized by the GeoFabric (or database) enabling you to have different Query Workers for different geo-regions as well as for different fabrics within same region."),(0,o.kt)("p",null,"For more information, refer to the ",(0,o.kt)("a",{parentName:"p",href:"/docs/c8ql/"},"C8 Query Language")," section."),(0,o.kt)("h2",{id:"sharding-and-replication"},"Sharding and Replication"),(0,o.kt)("p",null,"GDN uses the concepts of ",(0,o.kt)("em",{parentName:"p"},"shards")," and ",(0,o.kt)("em",{parentName:"p"},"replication")," to provide redundancy and availability."),(0,o.kt)("h3",{id:"sharding"},"Sharding"),(0,o.kt)("p",null,"Collection data is stored in shards. Shards are configured per collection so multiple shards of data form the collection as a whole. To determine which shard should store data, GDN performs a hash across the values. By default this hash is created from ",(0,o.kt)("inlineCode",{parentName:"p"},"_key"),"."),(0,o.kt)("p",null,"The number of shards is fixed at ",(0,o.kt)("inlineCode",{parentName:"p"},"16")," and cannot be changed. You can specify the ",(0,o.kt)("inlineCode",{parentName:"p"},"shard key")," as part of the collection creation."),(0,o.kt)("admonition",{type:"note"},(0,o.kt)("p",{parentName:"admonition"},"If you change the shard keys from their default (",(0,o.kt)("inlineCode",{parentName:"p"},"_key"),"), the following limitations apply:"),(0,o.kt)("ul",{parentName:"admonition"},(0,o.kt)("li",{parentName:"ul"},"Any queries will need to send a request to every shard in the collection. "),(0,o.kt)("li",{parentName:"ul"},"For new documents, you must use an automatically generated ",(0,o.kt)("inlineCode",{parentName:"li"},"_key"),"."))),(0,o.kt)("p",null,"GDN automatically distributes shards across nodes in a cluster."),(0,o.kt)("p",null,"If you want to use unique indexes (hash, skiplist, persistent) on sharded collections, you must include the fields used to determine the shard key as index attributes:"),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:null},"ShardKeys"),(0,o.kt)("th",{parentName:"tr",align:null},"IndexKeys"),(0,o.kt)("th",{parentName:"tr",align:null}))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"a"),(0,o.kt)("td",{parentName:"tr",align:null},"a"),(0,o.kt)("td",{parentName:"tr",align:null},"ok")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"a"),(0,o.kt)("td",{parentName:"tr",align:null},"b"),(0,o.kt)("td",{parentName:"tr",align:null},"not ok")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"a"),(0,o.kt)("td",{parentName:"tr",align:null},"a, b"),(0,o.kt)("td",{parentName:"tr",align:null},"ok")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"a, b"),(0,o.kt)("td",{parentName:"tr",align:null},"a"),(0,o.kt)("td",{parentName:"tr",align:null},"not ok")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"a, b"),(0,o.kt)("td",{parentName:"tr",align:null},"b"),(0,o.kt)("td",{parentName:"tr",align:null},"not ok")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"a, b"),(0,o.kt)("td",{parentName:"tr",align:null},"a, b"),(0,o.kt)("td",{parentName:"tr",align:null},"ok")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"a, b"),(0,o.kt)("td",{parentName:"tr",align:null},"a, b, c"),(0,o.kt)("td",{parentName:"tr",align:null},"ok")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"a, b, c"),(0,o.kt)("td",{parentName:"tr",align:null},"a, b"),(0,o.kt)("td",{parentName:"tr",align:null},"not ok")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"a, b, c"),(0,o.kt)("td",{parentName:"tr",align:null},"a, b, c"),(0,o.kt)("td",{parentName:"tr",align:null},"ok")))),(0,o.kt)("h3",{id:"replication-within-datacenter"},"Replication Within Datacenter"),(0,o.kt)("p",null,"Replication within a datacenter is synchronous and works on a per-shard basis. GDN configures each collection, how many copies of each shard are kept in the cluster. The default number of shard replicas per datacenter is ",(0,o.kt)("inlineCode",{parentName:"p"},"2"),". "),(0,o.kt)("p",null,"A replica can be declared as the leader and all other replicas become followers. GDN commits write operations to the leader before replicating to followers, then shows confirmation to the user. Read operations are hosted by the server with the leader replica."),(0,o.kt)("p",null,"If an instance that holds a follower copy of a shard fails, the leader can no longer synchronize its changes to that follower. After a short timeout (3 seconds), the leader gives up on the follower, declares it to be out of sync, and continues service without the follower. When the server with the follower copy comes back, it automatically resynchronizes its data with the leader and synchronous replication is restored."),(0,o.kt)("p",null,"If an instance that holds a leader copy of a shard fails, then the leader can no longer serve any requests. After 15 seconds of missed heartbeats, the supervision process promotes another shard to become the leader. The other surviving replicas automatically synchronize their data with the new leader. When the instance with the original leader comes online, it becomes a follower and synchronizes its data with the leader. Both leader and follower shards can be moved between instances without service interruptions."),(0,o.kt)("p",null,"Applications can create producers and consumers in any shard. If follower shards are not reachable, the producers and consumers are automatically synchronized when the follower shard comes back online. Ordering is still guaranteed on a per-producer basis. However, subscriptions are local so you must recreate the subscription in the desired datacenter."),(0,o.kt)("h3",{id:"replication-across-datacenters"},"Replication Across Datacenters"),(0,o.kt)("p",null,"When replicating across datacenters (also known as ",(0,o.kt)("em",{parentName:"p"},"geo-replication"),"), GDN uses asynchronous causal ordered replication. Messages can be be produced and consumed in any region."),(0,o.kt)("p",null,"Geo-replication is enabled at the GeoFabric level. The GeoFabric is replicated to all datacenters in the specified set any time messages are published to global streams or documents are added to collections."))}m.isMDXComponent=!0},5702:function(e,t,a){t.Z=a.p+"assets/images/macrometa-internals-c16cf1ec8554fa8baeaa786b08063f88.png"}}]);